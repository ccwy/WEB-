<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>宿舍管理系统</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#36CFC9',
                        accent: '#722ED1',
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .card-hover {
                transition: all 0.3s ease;
            }
            .card-hover:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            }
            .sidebar-item {
                @apply flex items-center px-4 py-3 text-gray-700 hover:bg-primary/5 hover:text-primary transition-all duration-200;
            }
            .sidebar-item.active {
                @apply bg-primary/10 text-primary font-medium border-l-4 border-primary;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
    <div class="flex flex-col lg:flex-row flex-1">
        <!-- 侧边栏导航 -->
        <aside class="bg-white shadow-sm w-full lg:w-64 lg:min-h-screen transition-all duration-300 z-10" id="sidebar">
            <div class="p-4 border-b border-gray-200 flex items-center justify-between lg:justify-center">
                <h1 class="text-xl font-bold text-primary">宿舍管理系统</h1>
                <button id="toggleSidebarBtn" class="lg:hidden text-gray-500 hover:text-gray-700">
                    <i class="fa fa-bars"></i>
                </button>
            </div>
            <nav class="py-2">
                <a href="index.html" class="sidebar-item active">
                    <i class="fa fa-tachometer w-5 text-center mr-3"></i>
                    <span>系统首页</span>
                </a>
                <a href="room-management/index.html" class="sidebar-item">
                    <i class="fa fa-building w-5 text-center mr-3"></i>
                    <span>房间管理</span>
                </a>
                <a href="../user/index.html" class="sidebar-item">
                    <i class="fa fa-users w-5 text-center mr-3"></i>
                    <span>用户管理</span>
                </a>
                <a href="dormitory-allocation/index.html" class="sidebar-item">
                    <i class="fa fa-exchange w-5 text-center mr-3"></i>
                    <span>宿舍分配</span>
                </a>
                <a href="utility-fees/index.html" class="sidebar-item">
                    <i class="fa fa-bolt w-5 text-center mr-3"></i>
                    <span>水电费管理</span>
                </a>
                <a href="announcements/index.html" class="sidebar-item">
                    <i class="fa fa-bullhorn w-5 text-center mr-3"></i>
                    <span>公告通知</span>
                </a>
                <a href="report-management/index.html" class="sidebar-item">
                    <i class="fa fa-bar-chart w-5 text-center mr-3"></i>
                    <span>报告管理</span>
                </a>
                <a href="operation-log/index.html" class="sidebar-item">
                    <i class="fa fa-history w-5 text-center mr-3"></i>
                    <span>操作日志</span>
                </a>
                <a href="system-settings/index.html" class="sidebar-item">
                    <i class="fa fa-cog w-5 text-center mr-3"></i>
                    <span>系统设置</span>
                </a>
            </nav>
            <div class="mt-auto p-4 border-t border-gray-200 hidden lg:block">
                <div class="flex items-center">
                    <img src="https://picsum.photos/id/1005/40/40" alt="用户头像" class="w-10 h-10 rounded-full mr-3">
                    <div>
                        <p class="font-medium text-sm">管理员</p>
                        <p class="text-xs text-gray-500">系统管理员</p>
                    </div>
                    <button class="ml-auto text-gray-500 hover:text-red-500">
                        <i class="fa fa-sign-out"></i>
                    </button>
                </div>
            </div>
        </aside>

        <!-- 主内容区 -->
        <main class="flex-1 transition-all duration-300" id="mainContent">
            <!-- 顶部导航 -->
            <header class="bg-white shadow-sm p-4 flex justify-between items-center">
                <div class="flex items-center">
                    <button id="mobileSidebarBtn" class="lg:hidden text-gray-500 hover:text-gray-700 mr-4">
                        <i class="fa fa-bars"></i>
                    </button>
                    <h2 class="text-xl font-semibold" id="pageTitle">系统首页</h2>
                </div>
                <div class="flex items-center">
                    <div class="text-sm mr-4" id="currentTime"></div>
                    <div class="relative">
                        <button class="flex items-center text-gray-700 hover:text-primary">
                            <i class="fa fa-bell-o mr-2"></i>
                            <span class="absolute -top-1 -right-1 w-4 h-4 bg-red-500 rounded-full text-white text-xs flex items-center justify-center">3</span>
                        </button>
                    </div>
                </div>
            </header>

            <!-- 页面内容 -->
            <div class="p-6">
                <!-- 统计卡片 -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white rounded-xl p-6 shadow-sm card-hover">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-gray-500 font-medium">总房间数</h3>
                            <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                                <i class="fa fa-building text-blue-600"></i>
                            </div>
                        </div>
                        <p class="text-3xl font-bold text-gray-800 mb-2">192</p>
                        <div class="flex items-center text-sm">
                            <span class="text-green-500 flex items-center">
                                <i class="fa fa-arrow-up mr-1"></i> 2.5%
                            </span>
                            <span class="text-gray-500 ml-2">较上月</span>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl p-6 shadow-sm card-hover">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-gray-500 font-medium">已入住人数</h3>
                            <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                                <i class="fa fa-users text-green-600"></i>
                            </div>
                        </div>
                        <p class="text-3xl font-bold text-gray-800 mb-2">528</p>
                        <div class="flex items-center text-sm">
                            <span class="text-green-500 flex items-center">
                                <i class="fa fa-arrow-up mr-1"></i> 5.3%
                            </span>
                            <span class="text-gray-500 ml-2">较上月</span>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl p-6 shadow-sm card-hover">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-gray-500 font-medium">空置房间数</h3>
                            <div class="w-10 h-10 bg-amber-100 rounded-full flex items-center justify-center">
                                <i class="fa fa-home text-amber-600"></i>
                            </div>
                        </div>
                        <p class="text-3xl font-bold text-gray-800 mb-2">24</p>
                        <div class="flex items-center text-sm">
                            <span class="text-red-500 flex items-center">
                                <i class="fa fa-arrow-down mr-1"></i> 8.3%
                            </span>
                            <span class="text-gray-500 ml-2">较上月</span>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl p-6 shadow-sm card-hover">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-gray-500 font-medium">未缴水电费</h3>
                            <div class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center">
                                <i class="fa fa-money text-purple-600"></i>
                            </div>
                        </div>
                        <p class="text-3xl font-bold text-gray-800 mb-2">¥6,322.50</p>
                        <div class="flex items-center text-sm">
                            <span class="text-green-500 flex items-center">
                                <i class="fa fa-arrow-down mr-1"></i> 12.1%
                            </span>
                            <span class="text-gray-500 ml-2">较上月</span>
                        </div>
                    </div>
                </div>
                
                <!-- 图表和数据 -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                    <div class="bg-white rounded-xl p-6 shadow-sm lg:col-span-2">
                        <h3 class="text-lg font-semibold mb-4">近6个月水电费趋势</h3>
                        <div class="h-80">
                            <canvas id="utilityTrendChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl p-6 shadow-sm">
                        <h3 class="text-lg font-semibold mb-4">房间入住率</h3>
                        <div class="h-64 mb-6">
                            <canvas id="occupancyRateChart"></canvas>
                        </div>
                        <div class="space-y-4">
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span>1号楼</span>
                                    <span>85%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-blue-500 h-2 rounded-full" style="width: 85%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span>2号楼</span>
                                    <span>92%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-blue-500 h-2 rounded-full" style="width: 92%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span>3号楼</span>
                                    <span>78%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-blue-500 h-2 rounded-full" style="width: 78%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span>4号楼</span>
                                    <span>88%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-blue-500 h-2 rounded-full" style="width: 88%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 最近公告和待办事项 -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white rounded-xl p-6 shadow-sm">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-semibold">最近公告</h3>
                            <a href="announcements/index.html" class="text-primary text-sm hover:underline">查看全部</a>
                        </div>
                        <div class="space-y-4">
                            <div class="border-l-4 border-red-500 pl-4 py-1">
                                <p class="font-medium mb-1">关于加强宿舍安全管理的通知</p>
                                <p class="text-sm text-gray-500">2024-03-28 · 管理员</p>
                            </div>
                            <div class="border-l-4 border-blue-500 pl-4 py-1">
                                <p class="font-medium mb-1">2024年4月份水电费缴纳通知</p>
                                <p class="text-sm text-gray-500">2024-04-01 · 管理员</p>
                            </div>
                            <div class="border-l-4 border-green-500 pl-4 py-1">
                                <p class="font-medium mb-1">关于宿舍卫生检查的公告</p>
                                <p class="text-sm text-gray-500">2024-03-25 · 管理员</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl p-6 shadow-sm">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-semibold">待办事项</h3>
                            <button class="text-primary text-sm hover:underline">新增</button>
                        </div>
                        <div class="space-y-3">
                            <div class="flex items-center p-3 border border-gray-200 rounded-lg">
                                <input type="checkbox" class="mr-3">
                                <div class="flex-1">
                                    <p class="font-medium">完成4月份水电费核算</p>
                                    <p class="text-sm text-gray-500">截止日期：2024-04-05</p>
                                </div>
                                <span class="px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs">紧急</span>
                            </div>
                            <div class="flex items-center p-3 border border-gray-200 rounded-lg">
                                <input type="checkbox" class="mr-3">
                                <div class="flex-1">
                                    <p class="font-medium">准备宿舍卫生检查</p>
                                    <p class="text-sm text-gray-500">截止日期：2024-04-04</p>
                                </div>
                                <span class="px-2 py-1 bg-amber-100 text-amber-800 rounded-full text-xs">中等</span>
                            </div>
                            <div class="flex items-center p-3 border border-gray-200 rounded-lg">
                                <input type="checkbox" class="mr-3" checked>
                                <div class="flex-1">
                                    <p class="font-medium line-through text-gray-400">更新宿舍用户信息</p>
                                    <p class="text-sm text-gray-500">截止日期：2024-04-02</p>
                                </div>
                                <span class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">已完成</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <footer class="bg-white border-t border-gray-200 py-4 mt-auto">
        <div class="container mx-auto px-4 text-center text-sm text-gray-500">
            <p>&copy; <span id="currentYear"></span> 宿舍管理系统 - 版权所有</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 侧边栏切换
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            const toggleSidebarBtn = document.getElementById('toggleSidebarBtn');
            const mobileSidebarBtn = document.getElementById('mobileSidebarBtn');
            
            function toggleSidebar() {
                sidebar.classList.toggle('hidden');
            }
            
            toggleSidebarBtn.addEventListener('click', toggleSidebar);
            mobileSidebarBtn.addEventListener('click', toggleSidebar);
            
            // 水电费趋势图表
            const utilityTrendCtx = document.getElementById('utilityTrendChart').getContext('2d');
            new Chart(utilityTrendCtx, {
                type: 'line',
                data: {
                    labels: ['10月', '11月', '12月', '1月', '2月', '3月'],
                    datasets: [
                        {
                            label: '电费',
                            data: [11200, 12500, 14800, 15200, 13800, 12560],
                            borderColor: '#3B82F6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.3,
                            fill: true
                        },
                        {
                            label: '水费',
                            data: [2800, 3100, 3400, 3600, 3300, 3245],
                            borderColor: '#10B981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.3,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ¥${context.raw}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '¥' + value;
                                }
                            }
                        }
                    }
                }
            });
            
            // 入住率图表
            const occupancyRateCtx = document.getElementById('occupancyRateChart').getContext('2d');
            new Chart(occupancyRateCtx, {
                type: 'doughnut',
                data: {
                    labels: ['已入住', '空置'],
                    datasets: [{
                        data: [168, 24],
                        backgroundColor: ['#3B82F6', '#E5E7EB'],
                        borderWidth: 0,
                        cutout: '70%'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = context.raw;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = Math.round((value / total) * 100);
                                    return `${context.label}: ${value}间 (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
            
            // 设置北京时区时间
            function updateDateTime() {
                const now = new Date();
                const options = { 
                    year: 'numeric', 
                    month: '2-digit', 
                    day: '2-digit', 
                    hour: '2-digit', 
                    minute: '2-digit', 
                    second: '2-digit',
                    hour12: false,
                    timeZone: 'Asia/Shanghai'
                };
                document.getElementById('currentTime').textContent = now.toLocaleString('zh-CN', options);
                document.getElementById('currentYear').textContent = now.getFullYear();
            }
            
            // 初始化时间并设置定时器
            updateDateTime();
            setInterval(updateDateTime, 1000);
        });
    </script>
</body>
</html>
