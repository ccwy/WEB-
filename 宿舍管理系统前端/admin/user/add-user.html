<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>添加用户 - 宿舍管理系统</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#36CFC9',
                        accent: '#722ED1',
                    },
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 min-h-screen">
    <header class="bg-primary text-white shadow-md">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <h1 class="text-xl font-bold">
                <a href="../dormitory/index.html" class="flex items-center">
                    <i class="fa fa-arrow-left mr-2"></i>
                    宿舍管理系统
                </a>
            </h1>
            <div class="text-sm" id="currentTime"></div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-6">
        <div class="flex items-center mb-6">
            <a href="index.html" class="text-primary hover:text-primary/80 mr-2">
                <i class="fa fa-arrow-left"></i>
            </a>
            <h2 class="text-2xl font-semibold text-dark">添加用户</h2>
        </div>
        
        <div class="bg-white rounded-lg shadow-sm p-6 max-w-3xl mx-auto">
            <form id="addPersonForm">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <label for="name" class="block text-sm font-medium text-gray-700 mb-1">姓名 <span class="text-red-500">*</span></label>
                        <input type="text" id="name" name="name" required
                               class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50">
                    </div>
                    
                    <div>
                        <label for="gender" class="block text-sm font-medium text-gray-700 mb-1">性别 <span class="text-red-500">*</span></label>
                        <div class="flex space-x-4">
                            <label class="inline-flex items-center">
                                <input type="radio" name="gender" value="男" checked class="text-primary focus:ring-primary">
                                <span class="ml-2">男</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" name="gender" value="女" class="text-primary focus:ring-primary">
                                <span class="ml-2">女</span>
                            </label>
                        </div>
                    </div>
                    
                    <div>
                        <label for="idCard" class="block text-sm font-medium text-gray-700 mb-1">身份证号码 <span class="text-red-500">*</span></label>
                        <input type="text" id="idCard" name="idCard" required maxlength="18"
                               class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50">
                        <p class="mt-1 text-xs text-gray-500">输入后将自动计算年龄</p>
                    </div>
                    
                    <div>
                        <label for="age" class="block text-sm font-medium text-gray-700 mb-1">年龄</label>
                        <input type="number" id="age" name="age" readonly
                               class="w-full px-4 py-2 border border-gray-300 bg-gray-50 rounded-md focus:outline-none">
                    </div>
                    
                    <div>
                        <label for="department" class="block text-sm font-medium text-gray-700 mb-1">部门 <span class="text-red-500">*</span></label>
                        <select id="department" name="department" required
                                class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50">
                            <option value="">请选择部门</option>
                            <option value="技术部">技术部</option>
                            <option value="市场部">市场部</option>
                            <option value="行政部">行政部</option>
                            <option value="财务部">财务部</option>
                            <option value="其他">其他</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="position" class="block text-sm font-medium text-gray-700 mb-1">岗位 <span class="text-red-500">*</span></label>
                        <input type="text" id="position" name="position" required
                               class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50">
                    </div>
                    
                    <div>
                        <label for="phone" class="block text-sm font-medium text-gray-700 mb-1">联系电话 <span class="text-red-500">*</span></label>
                        <input type="tel" id="phone" name="phone" required maxlength="11"
                               class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50">
                    </div>
                    
                    <div>
                        <label for="idAddress" class="block text-sm font-medium text-gray-700 mb-1">身份证地址</label>
                        <input type="text" id="idAddress" name="idAddress"
                               class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50">
                    </div>
                    
                    <div>
                        <label for="emergencyContact" class="block text-sm font-medium text-gray-700 mb-1">紧急联系人</label>
                        <input type="text" id="emergencyContact" name="emergencyContact"
                               class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50">
                    </div>
                    
                    <div>
                        <label for="emergencyPhone" class="block text-sm font-medium text-gray-700 mb-1">紧急联系人电话</label>
                        <input type="tel" id="emergencyPhone" name="emergencyPhone"
                               class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50">
                    </div>
                </div>
                
                <div class="mb-6">
                    <label for="notes" class="block text-sm font-medium text-gray-700 mb-1">备注</label>
                    <textarea id="notes" name="notes" rows="3"
                              class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50"></textarea>
                </div>
                
                <div class="flex justify-end gap-3">
                    <button type="button" onclick="window.location.href='index.html'" 
                            class="px-6 py-2 border border-gray-300 rounded-md hover:bg-gray-50">取消</button>
                    <button type="submit" 
                            class="px-6 py-2 bg-green-500 text-white rounded-md hover:bg-green-600">保存</button>
                </div>
            </form>
        </div>
    </main>

    <footer class="bg-dark text-white py-4 mt-8">
        <div class="container mx-auto px-4 text-center text-sm">
            <p>&copy; <span id="currentYear"></span> 宿舍管理系统 - 版权所有</p>
        </div>
    </footer>

    <script>
        // 从身份证号码提取年龄
        function calculateAgeFromIdCard(idCard) {
            if (idCard.length !== 18) return '';
            
            const birthYear = parseInt(idCard.substring(6, 10));
            const birthMonth = parseInt(idCard.substring(10, 12));
            const birthDay = parseInt(idCard.substring(12, 14));
            
            const today = new Date();
            const currentYear = today.getFullYear();
            const currentMonth = today.getMonth() + 1;
            const currentDay = today.getDate();
            
            let age = currentYear - birthYear;
            
            // 未到生日则减一岁
            if (currentMonth < birthMonth || (currentMonth === birthMonth && currentDay < birthDay)) {
                age--;
            }
            
            return age > 0 ? age : '';
        }
        
        // 表单提交处理
        document.addEventListener('DOMContentLoaded', function() {
            const idCardInput = document.getElementById('idCard');
            const ageInput = document.getElementById('age');
            const form = document.getElementById('addPersonForm');
            
            // 监听身份证输入，自动计算年龄
            idCardInput.addEventListener('input', function() {
                const age = calculateAgeFromIdCard(this.value);
                ageInput.value = age;
            });
            
            // 表单提交
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // 简单验证
                const name = document.getElementById('name').value;
                const idCard = document.getElementById('idCard').value;
                const department = document.getElementById('department').value;
                const phone = document.getElementById('phone').value;
                
                if (!name || !idCard || !department || !phone) {
                    alert('请填写所有必填字段');
                    return;
                }
                
                if (idCard.length !== 18) {
                    alert('请输入有效的18位身份证号码');
                    return;
                }
                
                if (phone.length !== 11) {
                    alert('请输入有效的11位手机号码');
                    return;
                }
                
                // 模拟提交成功
                alert('用户信息添加成功！');
                window.location.href = 'index.html';
            });
            
            // 设置北京时区时间
            function updateDateTime() {
                const now = new Date();
                const options = { 
                    year: 'numeric', 
                    month: '2-digit', 
                    day: '2-digit', 
                    hour: '2-digit', 
                    minute: '2-digit', 
                    second: '2-digit',
                    hour12: false,
                    timeZone: 'Asia/Shanghai'
                };
                document.getElementById('currentTime').textContent = now.toLocaleString('zh-CN', options);
                document.getElementById('currentYear').textContent = now.getFullYear();
            }
            
            // 初始化时间并设置定时器
            updateDateTime();
            setInterval(updateDateTime, 1000);
        });
    </script>
</body>
</html>
